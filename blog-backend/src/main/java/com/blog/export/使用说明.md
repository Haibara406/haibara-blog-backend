# ğŸ“Š æ•°æ®å¯¼å‡ºåŠŸèƒ½ä½¿ç”¨è¯´æ˜

## ğŸ¯ åŠŸèƒ½æ¦‚è¿°

æœ¬å¯¼å‡ºåŠŸèƒ½é‡‡ç”¨**ç­–ç•¥æ¨¡å¼ + å·¥å‚æ¨¡å¼**è®¾è®¡ï¼Œæ”¯æŒå°†ç³»ç»Ÿ8ä¸ªä¸šåŠ¡æ¨¡å—çš„æ•°æ®å¯¼å‡ºä¸ºHTMLæˆ–Excelæ ¼å¼ã€‚

## âœ… å·²å®ç°çš„ä¸šåŠ¡æ¨¡å—

| ä¸šåŠ¡æ¨¡å— | ä»£ç æ ‡è¯† | æ”¯æŒæ ¼å¼ | æƒé™è¦æ±‚ | æ•°æ®æºæ–¹æ³• |
|---------|---------|---------|---------|-----------|
| ç”¨æˆ·ç®¡ç† | `user` | HTML, Excel | `system:user:list` | `UserService.getUserOrSearch(null)` |
| è§’è‰²ç®¡ç† | `role` | HTML, Excel | `system:role:list` | `RoleService.selectRole(null)` |
| åˆ†ç±»ç®¡ç† | `category` | HTML, Excel | `blog:category:search` | `CategoryService.listAllCategory()` |
| æ ‡ç­¾ç®¡ç† | `tag` | HTML, Excel | `blog:tag:search` | `TagService.listAllTag()` |
| è¯„è®ºç®¡ç† | `comment` | HTML, Excel | `blog:comment:list` | `CommentService.getBackCommentList(null)` |
| é»‘åå•ç®¡ç† | `blackList` | HTML, Excel | `blog:black:select` | `BlackListService.getBlackList(null)` |
| ç™»å½•æ—¥å¿— | `loginLog` | HTML, Excel | `system:log:login:list` | `LoginLogService.searchLoginLog(null)` |
| æ“ä½œæ—¥å¿— | `operateLog` | HTML, Excel | `system:log:list` | `LogService.searchLog(null, 1L, 1000L)` |

## ğŸš€ API æ¥å£ä½¿ç”¨

### 1. å¯¼å‡ºæ•°æ®
```http
GET /export/{businessType}/{exportType}?fileName={fileName}
```

**å‚æ•°è¯´æ˜ï¼š**
- `businessType`: ä¸šåŠ¡ç±»å‹ï¼ˆuser, role, category, tag, comment, blackList, loginLog, operateLogï¼‰
- `exportType`: å¯¼å‡ºç±»å‹ï¼ˆhtml, excelï¼‰
- `fileName`: æ–‡ä»¶åï¼ˆå¯é€‰ï¼Œé»˜è®¤ä½¿ç”¨ä¸šåŠ¡ç±»å‹åç§°ï¼‰

**ä½¿ç”¨ç¤ºä¾‹ï¼š**
```bash
# å¯¼å‡ºç”¨æˆ·åˆ—è¡¨ä¸ºHTML
GET /export/user/html?fileName=ç”¨æˆ·ç®¡ç†åˆ—è¡¨

# å¯¼å‡ºè§’è‰²åˆ—è¡¨ä¸ºExcel
GET /export/role/excel?fileName=ç³»ç»Ÿè§’è‰²æ•°æ®

# å¯¼å‡ºè¯„è®ºåˆ—è¡¨ä¸ºHTML
GET /export/comment/html

# å¯¼å‡ºç™»å½•æ—¥å¿—ä¸ºExcel
GET /export/loginLog/excel?fileName=ç™»å½•æ—¥å¿—ç»Ÿè®¡
```

### 2. è·å–æ”¯æŒçš„ä¸šåŠ¡ç±»å‹
```http
GET /export/business-types
```

### 3. è·å–æŒ‡å®šä¸šåŠ¡æ”¯æŒçš„å¯¼å‡ºç±»å‹
```http
GET /export/export-types/{businessType}
```

### 4. æ£€æŸ¥å¯¼å‡ºæƒé™
```http
GET /export/permission/{businessType}
```

## ğŸ” æƒé™æ§åˆ¶

- **ç»Ÿä¸€å¯¼å‡ºæƒé™**: æ‰€æœ‰å¯¼å‡ºæ¥å£éƒ½éœ€è¦ `system:export` æƒé™
- **ä¸šåŠ¡æ•°æ®æƒé™**: æ¯ä¸ªä¸šåŠ¡æ¨¡å—è¿˜éœ€è¦å¯¹åº”çš„æ•°æ®è®¿é—®æƒé™ï¼ˆå¦‚ä¸Šè¡¨æ‰€ç¤ºï¼‰

## ğŸ“ æ–‡ä»¶ç»“æ„

```
blog-backend/src/main/java/com/blog/export/
â”œâ”€â”€ controller/
â”‚   â””â”€â”€ ExportController.java              # å¯¼å‡ºæ§åˆ¶å™¨
â”œâ”€â”€ service/
â”‚   â””â”€â”€ ExportService.java                 # å¯¼å‡ºæœåŠ¡
â”œâ”€â”€ strategy/
â”‚   â”œâ”€â”€ ExportStrategy.java                # å¯¼å‡ºç­–ç•¥æ¥å£
â”‚   â”œâ”€â”€ DataFetchStrategy.java             # æ•°æ®è·å–ç­–ç•¥æ¥å£
â”‚   â”œâ”€â”€ data/                              # æ•°æ®è·å–ç­–ç•¥å®ç°
â”‚   â”‚   â”œâ”€â”€ UserDataFetchStrategy.java
â”‚   â”‚   â”œâ”€â”€ RoleDataFetchStrategy.java
â”‚   â”‚   â”œâ”€â”€ CategoryDataFetchStrategy.java
â”‚   â”‚   â”œâ”€â”€ TagDataFetchStrategy.java
â”‚   â”‚   â”œâ”€â”€ CommentDataFetchStrategy.java
â”‚   â”‚   â”œâ”€â”€ BlackListDataFetchStrategy.java
â”‚   â”‚   â”œâ”€â”€ LoginLogDataFetchStrategy.java
â”‚   â”‚   â””â”€â”€ OperateLogDataFetchStrategy.java
â”‚   â”œâ”€â”€ html/                              # HTMLå¯¼å‡ºç­–ç•¥å®ç°
â”‚   â”‚   â”œâ”€â”€ UserHtmlExportStrategy.java
â”‚   â”‚   â”œâ”€â”€ RoleHtmlExportStrategy.java
â”‚   â”‚   â”œâ”€â”€ CategoryHtmlExportStrategy.java
â”‚   â”‚   â”œâ”€â”€ TagHtmlExportStrategy.java
â”‚   â”‚   â”œâ”€â”€ CommentHtmlExportStrategy.java
â”‚   â”‚   â”œâ”€â”€ BlackListHtmlExportStrategy.java
â”‚   â”‚   â”œâ”€â”€ LoginLogHtmlExportStrategy.java
â”‚   â”‚   â””â”€â”€ OperateLogHtmlExportStrategy.java
â”‚   â””â”€â”€ excel/                             # Excelå¯¼å‡ºç­–ç•¥å®ç°
â”‚       â”œâ”€â”€ UserExcelExportStrategy.java
â”‚       â”œâ”€â”€ RoleExcelExportStrategy.java
â”‚       â”œâ”€â”€ CategoryExcelExportStrategy.java
â”‚       â”œâ”€â”€ TagExcelExportStrategy.java
â”‚       â”œâ”€â”€ CommentExcelExportStrategy.java
â”‚       â”œâ”€â”€ BlackListExcelExportStrategy.java
â”‚       â”œâ”€â”€ LoginLogExcelExportStrategy.java
â”‚       â””â”€â”€ OperateLogExcelExportStrategy.java
â”œâ”€â”€ factory/
â”‚   â”œâ”€â”€ ExportStrategyFactory.java         # å¯¼å‡ºç­–ç•¥å·¥å‚
â”‚   â””â”€â”€ DataFetchFactory.java              # æ•°æ®è·å–å·¥å‚
â”œâ”€â”€ enums/
â”‚   â”œâ”€â”€ BusinessType.java                  # ä¸šåŠ¡ç±»å‹æšä¸¾
â”‚   â””â”€â”€ ExportType.java                    # å¯¼å‡ºç±»å‹æšä¸¾
â””â”€â”€ dto/
    â””â”€â”€ ExportResult.java                  # å¯¼å‡ºç»“æœDTO

blog-backend/src/main/resources/templates/export/
â”œâ”€â”€ user-export.html                       # ç”¨æˆ·HTMLå¯¼å‡ºæ¨¡æ¿
â”œâ”€â”€ role-export.html                       # è§’è‰²HTMLå¯¼å‡ºæ¨¡æ¿
â”œâ”€â”€ category-export.html                   # åˆ†ç±»HTMLå¯¼å‡ºæ¨¡æ¿
â”œâ”€â”€ tag-export.html                        # æ ‡ç­¾HTMLå¯¼å‡ºæ¨¡æ¿
â”œâ”€â”€ comment-export.html                    # è¯„è®ºHTMLå¯¼å‡ºæ¨¡æ¿
â”œâ”€â”€ blacklist-export.html                  # é»‘åå•HTMLå¯¼å‡ºæ¨¡æ¿
â”œâ”€â”€ loginlog-export.html                   # ç™»å½•æ—¥å¿—HTMLå¯¼å‡ºæ¨¡æ¿
â””â”€â”€ operatelog-export.html                 # æ“ä½œæ—¥å¿—HTMLå¯¼å‡ºæ¨¡æ¿ï¼ˆå¾…åˆ›å»ºï¼‰
```

## ğŸ¨ HTMLæ¨¡æ¿ç‰¹è‰²

æ¯ä¸ªä¸šåŠ¡æ¨¡å—éƒ½æœ‰ä¸“é—¨è®¾è®¡çš„HTMLå¯¼å‡ºæ¨¡æ¿ï¼Œå…·å¤‡ä»¥ä¸‹ç‰¹ç‚¹ï¼š

- **å“åº”å¼è®¾è®¡**: æ”¯æŒä¸åŒå±å¹•å°ºå¯¸
- **æ‰“å°ä¼˜åŒ–**: ä¸“é—¨çš„æ‰“å°æ ·å¼
- **ç¾è§‚ç•Œé¢**: æ¸å˜è‰²å½©æ­é…ï¼Œä¸“ä¸šæŠ¥è¡¨æ ·å¼
- **æ•°æ®ç»‘å®š**: ä½¿ç”¨Thymeleafæ¨¡æ¿å¼•æ“
- **äº¤äº’æ•ˆæœ**: é¼ æ ‡æ‚¬åœã€åŠ¨ç”»æ•ˆæœç­‰

## ğŸ”§ æŠ€æœ¯æ¶æ„

### æ ¸å¿ƒè®¾è®¡æ¨¡å¼

1. **ç­–ç•¥æ¨¡å¼**: ä¸åŒçš„å¯¼å‡ºæ ¼å¼ï¼ˆHTMLã€Excelï¼‰ä½¿ç”¨ä¸åŒçš„ç­–ç•¥
2. **å·¥å‚æ¨¡å¼**: è‡ªåŠ¨æ³¨å†Œå’Œç®¡ç†æ‰€æœ‰ç­–ç•¥å®ä¾‹
3. **æ¨¡æ¿æ–¹æ³•æ¨¡å¼**: ç»Ÿä¸€çš„å¯¼å‡ºæµç¨‹ï¼Œå…·ä½“å®ç°ç”±å­ç±»å®Œæˆ

### æ‰©å±•æ€§è®¾è®¡

- **æ·»åŠ æ–°ä¸šåŠ¡æ¨¡å—**: åªéœ€å®ç°3ä¸ªç­–ç•¥ç±»ï¼ˆæ•°æ®è·å–ã€HTMLå¯¼å‡ºã€Excelå¯¼å‡ºï¼‰
- **æ·»åŠ æ–°å¯¼å‡ºæ ¼å¼**: åªéœ€å®ç°æ–°çš„å¯¼å‡ºç­–ç•¥ï¼ˆå¦‚PDFå¯¼å‡ºï¼‰
- **è‡ªåŠ¨æ³¨å†Œ**: Springå¯åŠ¨æ—¶è‡ªåŠ¨å‘ç°å¹¶æ³¨å†Œæ‰€æœ‰ç­–ç•¥

## ğŸ“Š å¯¼å‡ºæ•ˆæœ

### HTMLå¯¼å‡ºç‰¹ç‚¹
- ç²¾ç¾çš„æŠ¥è¡¨æ ·å¼ï¼Œæ”¯æŒæ‰“å°
- å®æ—¶æ•°æ®ç»Ÿè®¡ï¼ˆæ€»æ•°ã€å¯¼å‡ºæ—¶é—´ç­‰ï¼‰
- ä¸åŒä¸šåŠ¡æ¨¡å—æœ‰ä¸åŒçš„è‰²å½©ä¸»é¢˜
- æ”¯æŒé•¿å†…å®¹çš„çœç•¥æ˜¾ç¤º

### Excelå¯¼å‡ºç‰¹ç‚¹
- ä¸“ä¸šçš„è¡¨æ ¼æ ¼å¼
- è‡ªåŠ¨åˆ—å®½è°ƒæ•´
- å½©è‰²è¡¨å¤´è®¾è®¡
- æ•°æ®ç±»å‹è‡ªåŠ¨è¯†åˆ«

## ğŸš€ ä½¿ç”¨ç¤ºä¾‹

### å‰ç«¯è°ƒç”¨ç¤ºä¾‹
```javascript
// å¯¼å‡ºç”¨æˆ·åˆ—è¡¨ä¸ºHTML
window.open('/export/user/html?fileName=ç”¨æˆ·ç®¡ç†åˆ—è¡¨', '_blank');

// å¯¼å‡ºè§’è‰²åˆ—è¡¨ä¸ºExcel
fetch('/export/role/excel?fileName=è§’è‰²æ•°æ®ç»Ÿè®¡')
  .then(response => response.blob())
  .then(blob => {
    const url = window.URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = 'è§’è‰²æ•°æ®ç»Ÿè®¡.xlsx';
    a.click();
  });
```

### åç«¯æ‰©å±•ç¤ºä¾‹
```java
// æ·»åŠ æ–°çš„ä¸šåŠ¡æ¨¡å—å¯¼å‡ºï¼ˆä»¥æ–‡ç« ç®¡ç†ä¸ºä¾‹ï¼‰

// 1. åœ¨BusinessTypeæšä¸¾ä¸­æ·»åŠ 
ARTICLE("article", "æ–‡ç« ç®¡ç†", ArticleListVO.class)

// 2. åˆ›å»ºæ•°æ®è·å–ç­–ç•¥
@Component
public class ArticleDataFetchStrategy implements DataFetchStrategy<ArticleListVO> {
    @Override
    public List<ArticleListVO> fetchData() {
        return articleService.getBackArticleList(null);
    }
    // ... å…¶ä»–æ–¹æ³•
}

// 3. åˆ›å»ºHTMLå¯¼å‡ºç­–ç•¥
@Component
public class ArticleHtmlExportStrategy implements ExportStrategy<ArticleListVO> {
    // ... å®ç°å¯¼å‡ºé€»è¾‘
}

// 4. åˆ›å»ºExcelå¯¼å‡ºç­–ç•¥
@Component
public class ArticleExcelExportStrategy implements ExportStrategy<ArticleListVO> {
    // ... å®ç°å¯¼å‡ºé€»è¾‘
}

// 5. åˆ›å»ºHTMLæ¨¡æ¿
// resources/templates/export/article-export.html
```

## ğŸ¯ æ€»ç»“

æœ¬å¯¼å‡ºåŠŸèƒ½å®Œå…¨æŒ‰ç…§æ‚¨çš„éœ€æ±‚å®ç°ï¼š

âœ… **æ”¯æŒ8ä¸ªä¸šåŠ¡æ¨¡å—çš„å¯¼å‡º**  
âœ… **ç­–ç•¥æ¨¡å¼ + å·¥å‚æ¨¡å¼æ¶æ„**  
âœ… **HTMLå’ŒExcelä¸¤ç§å¯¼å‡ºæ ¼å¼**  
âœ… **æ¯ä¸ªä¸šåŠ¡éƒ½æœ‰ä¸“é—¨çš„HTMLæ¨¡æ¿**  
âœ… **å¤ç”¨ç°æœ‰çš„ä¸šåŠ¡æ–¹æ³•è·å–æ•°æ®**  
âœ… **å®Œå–„çš„æƒé™æ§åˆ¶**  
âœ… **é«˜åº¦å¯æ‰©å±•çš„è®¾è®¡**  

ç°åœ¨æ‚¨å¯ä»¥é€šè¿‡APIæ¥å£å¯¼å‡ºä»»ä½•ä¸šåŠ¡æ¨¡å—çš„æ•°æ®ï¼Œç”Ÿæˆä¸“ä¸šç¾è§‚çš„HTMLæŠ¥è¡¨æˆ–Excelæ–‡ä»¶ï¼